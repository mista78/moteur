# DÃ©compte dans l'Interface Web - RÃ©sumÃ© Visuel

## Avant vs AprÃ¨s

### AVANT (Sans dÃ©compte)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RÃ©sultats du calcul IJ                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Trimestres d'affiliation: 16 trimestres                     â”‚
â”‚ Nombre de jours indemnisables: 31 jours                     â”‚
â”‚ Montant total: 2,326.86 â‚¬                                   â”‚
â”‚ Cumul total de jours: 121 jours                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DÃ©tail des paiements par arrÃªt
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NÂ° â”‚ DÃ©but      â”‚ Fin        â”‚ Date effet â”‚ Jours   â”‚ Montant    â”‚
â”‚    â”‚ arrÃªt      â”‚ arrÃªt      â”‚            â”‚ payÃ©s   â”‚            â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ 2024-01-01 â”‚ 2024-04-30 â”‚ 2024-03-31 â”‚   31    â”‚ 2,326.86â‚¬  â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ProblÃ¨me** : On ne voit pas les 90 jours qui ont Ã©tÃ© nÃ©cessaires avant le paiement!

---

### APRÃˆS (Avec dÃ©compte) âœ¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RÃ©sultats du calcul IJ                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Trimestres d'affiliation: 16 trimestres                     â”‚
â”‚ Nombre de jours indemnisables: 31 jours                     â”‚
â”‚                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ â±ï¸ DÃ©compte total (jours non payÃ©s): 90 jours       â”‚   â”‚
â”‚ â”‚ (fond jaune, texte orange)                           â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚ Montant total: 2,326.86 â‚¬                                   â”‚
â”‚ Cumul total de jours: 121 jours                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

DÃ©tail des paiements par arrÃªt
â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NÂ° â”‚ DÃ©but      â”‚ Fin        â”‚ DurÃ©e  â”‚ DÃ©compte   â”‚ Date effet â”‚ Jours   â”‚ Montant    â”‚
â”‚    â”‚ arrÃªt      â”‚ arrÃªt      â”‚        â”‚ (non payÃ©) â”‚            â”‚ payÃ©s   â”‚            â”‚
â”œâ”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ 2024-01-01 â”‚ 2024-04-30 â”‚  121j  â”‚  ğŸŸ¨ 90j   â”‚ 2024-03-31 â”‚   31    â”‚ 2,326.86â‚¬  â”‚
â”‚    â”‚            â”‚            â”‚        â”‚ (gras)     â”‚            â”‚         â”‚            â”‚
â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â„¹ï¸ DÃ©compte (jours non payÃ©s) :                                          â”‚
â”‚                                                                           â”‚
â”‚ Le dÃ©compte reprÃ©sente les jours qui comptent vers le seuil             â”‚
â”‚ (90 jours pour nouvelle pathologie, 15 jours pour rechute)              â”‚
â”‚ mais qui ne sont pas payÃ©s car situÃ©s avant la date d'effet.            â”‚
â”‚                                                                           â”‚
â”‚ Exemple: Un arrÃªt de 120 jours avec date d'effet au jour 91 aura        â”‚
â”‚ 90 jours de dÃ©compte et 30 jours payables.                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Avantage** : Tout est clair maintenant! 121j = 90j (dÃ©compte) + 31j (payÃ©s)

---

## DÃ©tails des modifications visuelles

### 1. RÃ©sumÃ© principal - Nouvelle ligne jaune

**Emplacement** : Entre "Jours indemnisables" et "Montant total"

**Style** :
- Fond : `#fff9e6` (jaune trÃ¨s clair)
- Texte : `#856404` (orange foncÃ©)
- Police : Gras
- IcÃ´ne : â±ï¸

**Condition** : AffichÃ© uniquement si dÃ©compte > 0

**Code** :
```javascript
â±ï¸ DÃ©compte total (jours non payÃ©s): 90 jours
```

---

### 2. Tableau dÃ©taillÃ© - Nouvelle colonne "DÃ©compte"

**Position** : AprÃ¨s "DurÃ©e" et avant "Date effet"

**En-tÃªte** :
```html
<th>DÃ©compte<br>(non payÃ©)</th>
```

**Cellules** :

**Cas 1 : DÃ©compte > 0**
```html
<td style="background-color: #fff3cd; color: #856404; font-weight: bold;">
    90j
</td>
```
- Fond jaune pÃ¢le
- Texte orange foncÃ©
- Gras

**Cas 2 : DÃ©compte = 0**
```html
<td style="color: #999;">
    0j
</td>
```
- Texte gris clair
- Pas de fond colorÃ©

---

### 3. EncadrÃ© explicatif

**Position** : Sous le tableau, avant "RÃ©capitulatif par pÃ©riode"

**Style** :
- Fond : `#e7f3ff` (bleu trÃ¨s clair)
- Bordure gauche : 4px solide `#667eea` (bleu)
- Padding : 12px
- Border-radius : 4px
- IcÃ´ne : â„¹ï¸

**Texte** :
- Titre en couleur `#667eea` (bleu)
- Corps en `#555` (gris foncÃ©)
- Taille : 13px
- Exemple en italique

---

## Cas d'usage dans l'interface

### Cas 1 : Nouvelle pathologie (90 jours de dÃ©compte)

```
ArrÃªt #1:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PÃ©riode: 2024-01-01 â†’ 2024-04-30                         â”‚
â”‚ DurÃ©e: 121j                                               â”‚
â”‚ DÃ©compte (non payÃ©): ğŸŸ¨ 90j  â† Fond jaune, gras         â”‚
â”‚   â†’ Du 2024-01-01 au 2024-03-30 (accumulation)           â”‚
â”‚ Date effet: 2024-03-31                                    â”‚
â”‚ Jours payÃ©s: 31                                           â”‚
â”‚ PÃ©riode de paiement: 2024-03-31 â†’ 2024-04-30            â”‚
â”‚ Montant: 2,326.86 â‚¬                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Calcul:
90 jours (dÃ©compte) + 31 jours (payÃ©s) = 121 jours (total)
```

### Cas 2 : Rechute (15 jours de dÃ©compte)

```
ArrÃªt #2 (RECHUTE):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PÃ©riode: 2024-01-01 â†’ 2024-02-29                         â”‚
â”‚ DurÃ©e: 60j                                                â”‚
â”‚ DÃ©compte (non payÃ©): ğŸŸ¨ 14j  â† Plus court pour rechute  â”‚
â”‚   â†’ Du 2024-01-01 au 2024-01-14 (accumulation)           â”‚
â”‚ Date effet: 2024-01-15                                    â”‚
â”‚ Jours payÃ©s: 46                                           â”‚
â”‚ PÃ©riode de paiement: 2024-01-15 â†’ 2024-02-29            â”‚
â”‚ Montant: 3,383.96 â‚¬                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Calcul:
14 jours (dÃ©compte) + 46 jours (payÃ©s) = 60 jours (total)
```

### Cas 3 : Pas de dÃ©compte (date d'effet forcÃ©e)

```
ArrÃªt #3:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PÃ©riode: 2024-03-01 â†’ 2024-03-31                         â”‚
â”‚ DurÃ©e: 31j                                                â”‚
â”‚ DÃ©compte (non payÃ©): 0j  â† Gris, pas de fond            â”‚
â”‚ Date effet: 2024-03-01  â† MÃªme jour que dÃ©but           â”‚
â”‚ Jours payÃ©s: 31                                           â”‚
â”‚ PÃ©riode de paiement: 2024-03-01 â†’ 2024-03-31            â”‚
â”‚ Montant: 2,280.22 â‚¬                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Calcul:
0 jours (dÃ©compte) + 31 jours (payÃ©s) = 31 jours (total)
```

---

## Comment tester dans le navigateur

### Ã‰tape 1 : Ouvrir l'interface
```bash
# Dans le terminal
cd /home/mista/work/ij
php -S localhost:8000
```

### Ã‰tape 2 : AccÃ©der Ã  l'interface
Ouvrir dans le navigateur :
```
http://localhost:8000/index.html
```

### Ã‰tape 3 : Charger un mock
Cliquer sur : **ğŸ“‹ Mock 1** ou **ğŸ“‹ Mock 2**

### Ã‰tape 4 : Calculer
Cliquer sur : **ğŸ’° Calculer Tout**

### Ã‰tape 5 : Observer les rÃ©sultats

**Vous devriez voir** :
1. âœ… Ligne jaune "DÃ©compte total" dans le rÃ©sumÃ©
2. âœ… Colonne "DÃ©compte (non payÃ©)" dans le tableau
3. âœ… Cellules jaunes pour dÃ©compte > 0
4. âœ… EncadrÃ© bleu explicatif sous le tableau

---

## Code couleur - Aide visuelle

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LÃ‰GENDE COULEURS                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚ ğŸŸ¨ Jaune (#fff3cd / #fff9e6)                          â”‚
â”‚    â†’ DÃ©compte (jours non payÃ©s)                       â”‚
â”‚    â†’ Accumulation vers le seuil                        â”‚
â”‚                                                         â”‚
â”‚ ğŸŸ¦ Bleu (#e7f3ff / #667eea)                           â”‚
â”‚    â†’ Information / Explication                         â”‚
â”‚    â†’ EncadrÃ© pÃ©dagogique                               â”‚
â”‚                                                         â”‚
â”‚ âšª Gris (#999)                                          â”‚
â”‚    â†’ DÃ©compte = 0                                      â”‚
â”‚    â†’ Pas d'accumulation nÃ©cessaire                     â”‚
â”‚                                                         â”‚
â”‚ ğŸŸ© Vert (#28a745)                                      â”‚
â”‚    â†’ Jours payÃ©s                                       â”‚
â”‚    â†’ Statut "Paid"                                     â”‚
â”‚                                                         â”‚
â”‚ ğŸŸ¥ Rouge (#dc3545)                                     â”‚
â”‚    â†’ Jours non payÃ©s (bloquÃ©s)                        â”‚
â”‚    â†’ Erreur / Statut bloquant                          â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## VÃ©rification rapide

Pour vÃ©rifier que tout fonctionne :

```bash
# 1. Lancer les tests PHP
php run_all_tests.php
# RÃ©sultat attendu: âœ“ ALL TESTS PASSED (114 tests)

# 2. Tester le dÃ©compte
php test_decompte.php
# VÃ©rifie que decompte_days est bien calculÃ©

# 3. Tester le dÃ©compte rechute
php test_decompte_rechute.php
# VÃ©rifie le seuil de 15 jours pour rechute

# 4. Ouvrir l'interface web
# Charger Mock 1 ou Mock 2 et observer les nouvelles colonnes
```

---

## RÃ©sumÃ© des fichiers modifiÃ©s

âœ… **app.js** - Interface web
- Ligne 896 : Ajout colonne "DÃ©compte"
- Lignes 856-871 : Calcul dÃ©compte total
- Lignes 905-912 : Affichage cellules dÃ©compte
- Lignes 943-952 : EncadrÃ© explicatif

âœ… **Services/DateService.php** - Calcul backend
- Lignes 614-646 : MÃ©thode `calculateDecompteDays()`
- Tous les `payment_details` incluent maintenant `decompte_days`

âœ… **Documentation**
- DECOMPTE_FEATURE.md - Documentation complÃ¨te
- WEB_INTERFACE_DECOMPTE.md - Ce fichier (guide visuel)

---

## Formule de vÃ©rification

Pour chaque arrÃªt, vous pouvez vÃ©rifier :

```
DurÃ©e totale â‰¥ DÃ©compte + Jours payÃ©s

Exemple:
121j (durÃ©e) = 90j (dÃ©compte) + 31j (payÃ©s) âœ“
```

**Note** : L'inÃ©galitÃ© (â‰¥) est utilisÃ©e car les jours payÃ©s peuvent Ãªtre limitÃ©s par l'attestation ou la date actuelle.
